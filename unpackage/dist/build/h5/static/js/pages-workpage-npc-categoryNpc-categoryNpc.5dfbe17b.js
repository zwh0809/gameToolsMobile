(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-workpage-npc-categoryNpc-categoryNpc"],{"0119":function(t,a,s){"use strict";var e=s("288e");Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var o=e(s("e814"));s("7f7f");var n=e(s("f499")),i=e(s("a745")),l={data:function(){return{postdata:{npcClassAttrVos:[{name:"跟随玩家",value:"",nickname:"",isBase:!0},{name:"可被询问",value:"",nickname:"",isBase:!0},{name:"所在地点",value:"",nickname:"",isBase:!0},{name:"能否说话",value:"",nickname:"",isBase:!0}],id:"",name:"",intro:"",projectId:""},NPClist:[],Maplist:[],allNPClist:[],allMaplist:[],steps1:{step_1_value:"name"},inquire:[["是","否"]],inquire2:[["是","否"]],inquire3:[["能","否"]],addotherpropertylist:[],workinfo:{},operation:"push",pickerValue1:"",pickerValue2:"",updateview:!0}},methods:{deepCopy:function(t){var a=(0,i.default)(t)?[]:{};for(var s in t)t.hasOwnProperty(s)&&("object"===typeof t[s]&&null!==t[s]?a[s]=this.deepCopy(t[s]):a[s]=t[s]);return a},demo:function(t){},submitdata:function(){var t=JSON.parse((0,n.default)(this.postdata));if(console.log(this.operation,"状态"),"push"===this.operation){for(var a in t.npcClassAttrVos)""===t.npcClassAttrVos[a].nickname&&(t.npcClassAttrVos[a].nickname=null);if(t.npcClassAttrVos=t.npcClassAttrVos.concat(this.addotherpropertylist),""!==t.npcClassAttrVos[0].value){console.log("发生了");var s=t.npcClassAttrVos[0].value.data[0];"否"===s?t.npcClassAttrVos[0].value="否":"是"===s&&(t.npcClassAttrVos[0].value="是")}if(""!==t.npcClassAttrVos[1].value){var e=t.npcClassAttrVos[1].value.data[0];"否"===e?t.npcClassAttrVos[1].value="否":"是"===e&&(t.npcClassAttrVos[1].value="是")}if(""!==t.npcClassAttrVos[2].value){var o=t.npcClassAttrVos[2].value.data[0];for(var a in this.allMaplist)this.allMaplist[a].name===o&&(t.npcClassAttrVos[2].value=this.allMaplist[a].id)}if(""!==t.npcClassAttrVos[3].value){console.log("发生了");var i=t.npcClassAttrVos[3].value.data[0];"否"===i?t.npcClassAttrVos[3].value="否":"能"===i&&(t.npcClassAttrVos[3].value="能")}if(!t.name)return void uni.showToast({icon:"none",title:"分类名称不能为空"});if(!t.npcClassAttrVos[0].value)return void uni.showToast({icon:"none",title:"请选择是否可跟随玩家"});if(!t.npcClassAttrVos[1].value)return void uni.showToast({icon:"none",title:"请选择可被询问"});if(!t.npcClassAttrVos[2].value)return void uni.showToast({icon:"none",title:"请选择所在地点"});if(!t.npcClassAttrVos[3].value)return void uni.showToast({icon:"none",title:"能否说话"});t.projectId=this.workinfo.id,console.log(t,"提交的数据");var l=this;l.$request.post("/npc/class/",t).then(function(t){console.log(t),1===t.code?uni.showModal({title:"提示",content:"添加类别成功",cancelText:"继续添加",confirmText:"返回列表",success:function(t){t.confirm?(console.log("点击确定"),uni.navigateBack({delta:1})):t.cancel}}):uni.showModal({title:"提示",content:t.msg,cancelText:"继续添加",confirmText:"返回列表",success:function(t){t.confirm?(console.log("点击确定"),uni.navigateBack({delta:1})):t.cancel}})}).catch(function(t){console.log(t)})}else if("change"===this.operation){for(var a in t.npcClassAttrVos)""===t.npcClassAttrVos[a].nickname&&(t.npcClassAttrVos[a].nickname=null);if(t.npcClassAttrVos=t.npcClassAttrVos.concat(this.addotherpropertylist),""!==t.npcClassAttrVos[0].value){var r=t.npcClassAttrVos[0].value.data[0];"否"===r?t.npcClassAttrVos[0].value="否":"是"===r&&(t.npcClassAttrVos[0].value="是")}if(""!==t.npcClassAttrVos[1].value){var c=t.npcClassAttrVos[1].value.data[0];"否"===c?t.npcClassAttrVos[1].value="否":"是"===c&&(t.npcClassAttrVos[1].value="是")}if(""!==t.npcClassAttrVos[2].value){var p=t.npcClassAttrVos[2].value.data[0];for(var a in this.allMaplist)this.allMaplist[a].name===p&&(t.npcClassAttrVos[2].value=this.allMaplist[a].id)}if(""!==t.npcClassAttrVos[3].value){var u=t.npcClassAttrVos[3].value.data[0];"能"===u?t.npcClassAttrVos[3].value="能":"否"===u&&(t.npcClassAttrVos[3].value="否")}if(!t.name)return void uni.showToast({icon:"none",title:"分类名称不能为空"});if(!t.npcClassAttrVos[0].value)return void uni.showToast({icon:"none",title:"请选择是否可跟随玩家"});if(!t.npcClassAttrVos[1].value)return void uni.showToast({icon:"none",title:"请选择可被询问"});if(!t.npcClassAttrVos[2].value)return void uni.showToast({icon:"none",title:"请选择所在地点"});if(!t.npcClassAttrVos[3].value)return void uni.showToast({icon:"none",title:"能否说话"});console.log(t,"编辑提交的数据"),t.projectId=this.workinfo.id;var d=this;d.$request.put("/npc/class//"+t.id+"/",t).then(function(t){console.log(t),1===t.code?uni.showModal({title:"提示",content:"编辑类别成功",cancelText:"继续编辑",confirmText:"返回列表",success:function(t){t.confirm?(console.log("点击确定"),uni.navigateBack({delta:1})):t.cancel}}):uni.showModal({title:"提示",content:t.msg,cancelText:"继续编辑",confirmText:"返回列表",success:function(t){t.confirm?(console.log("点击确定"),uni.navigateBack({delta:1})):t.cancel}})}).catch(function(t){console.log(t)})}},deleteohter:function(t){var a=this.addotherpropertylist.indexOf(t);-1!==a&&this.addotherpropertylist.splice(a,1)},addotherproperty:function(){var t={name:"",value:"",nickname:"",isBase:!0};this.addotherpropertylist.push(t)},getmaplist:function(){var t=this;t.$request.get("/place/?projectId="+t.workinfo.id).then(function(a){var s=[[]];for(var e in a.data)s[0].push(a.data[e].name);t.allMaplist=a.data,t.Maplist=s,t.setPickerDatac()}).catch(function(t){console.error("error:",t)})},initialize1:function(){var t=this;t.$request.get("/place/?projectId="+t.workinfo.id).then(function(a){var s=[[]];for(var e in a.data)s[0].push(a.data[e].name);if(t.allMaplist=a.data,t.Maplist=s,""!==t.postdata.npcClassAttrVos[2].value){var n=t.postdata.npcClassAttrVos[2].value;for(var e in t.allMaplist)t.allMaplist[e].id===(0,o.default)(n)&&(t.postdata.npcClassAttrVos[2].value={data:[t.allMaplist[e].name],value:[(0,o.default)(e)]},t.$set(t.postdata.npcClassAttrVos,2,t.postdata.npcClassAttrVos[2]))}t.updateview=!0,console.log(t.updateview,"此时的updateview"),t.$nextTick(function(){t.setPickerDatac2()})}).catch(function(t){console.error("error:",t)})},setPickerDatac:function(){this.$refs.pickerCustom1.setData(this.inquire),this.$refs.pickerCustom2.setData(this.inquire2),this.$refs.pickerCustom3.setData(this.Maplist),this.$refs.pickerCustom4.setData(this.inquire3)},setPickerDatac2:function(){this.$refs.pickerCustom1.setData(this.inquire),this.$refs.pickerCustom2.setData(this.inquire2),this.$refs.pickerCustom3.setData(this.Maplist),this.$refs.pickerCustom4.setData(this.inquire3)}},mounted:function(){},onShow:function(){},onLoad:function(t){var a=uni.getStorageSync("workinfo");if(this.workinfo=a,t.categoryNpc){this.operation="change",this.updateview=!1,this.initialize1();var s=JSON.parse(t.categoryNpc);console.log(s,"接收的数据");var e=[];for(var o in s.npcClassAttrVos)null===s.npcClassAttrVos[o].nickname&&(s.npcClassAttrVos[o].nickname=""),o>3&&e.push(s.npcClassAttrVos[o]);if(this.addotherpropertylist=e,this.postdata=s,""!==this.postdata.npcClassAttrVos[0].value){var n=this.postdata.npcClassAttrVos[0].value;"是"===n?this.postdata.npcClassAttrVos[0].value={data:["是"],value:[0]}:"否"===n&&(this.postdata.npcClassAttrVos[0].value={data:["否"],value:[1]})}if(""!==this.postdata.npcClassAttrVos[1].value){var i=this.postdata.npcClassAttrVos[1].value;"是"===i?this.postdata.npcClassAttrVos[1].value={data:["是"],value:[0]}:"否"===i&&(this.postdata.npcClassAttrVos[1].value={data:["否"],value:[1]})}if(""!==this.postdata.npcClassAttrVos[3].value){var l=this.postdata.npcClassAttrVos[3].value;"能"===l?this.postdata.npcClassAttrVos[3].value={data:["能"],value:[0]}:"否"===l&&(this.postdata.npcClassAttrVos[3].value={data:["否"],value:[1]})}}else this.updateview=!0,this.operation="push",this.pickerValue1="请选择",this.pickerValue2="请选择",this.getmaplist()}};a.default=l},"2d17":function(t,a,s){"use strict";var e=s("8bb9"),o=s.n(e);o.a},"393e":function(t,a,s){a=t.exports=s("2350")(!1),a.push([t.i,".property[data-v-2fd516f0]{font-size:%?32?%;color:#666;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column}.one_property[data-v-2fd516f0]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;border:1px solid #f8f8f8;margin-top:%?20?%}.one_property2[data-v-2fd516f0]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row}.title[data-v-2fd516f0]{margin-left:%?20?%}.uni-button[data-v-2fd516f0]{text-align:center;font-size:%?32?%;color:#666;height:%?60?%;line-height:%?60?%;border-radius:%?10?%;margin-top:%?20?%;margin-left:0}.other[data-v-2fd516f0]{padding:10px;width:30%!important}.icon[data-v-2fd516f0]{margin-top:%?40?%}.uni-button2[data-v-2fd516f0]{width:100%;margin-top:%?20?%}.othermm[data-v-2fd516f0] .flex_row_e_c{color:#666!important}.childrenBOX[data-v-2fd516f0]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row}",""])},"8bb9":function(t,a,s){var e=s("393e");"string"===typeof e&&(e=[[t.i,e,""]]),e.locals&&(t.exports=e.locals);var o=s("4f06").default;o("1bf745f0",e,!0,{sourceMap:!1,shadowMode:!1})},"9aa9f":function(t,a,s){"use strict";s.r(a);var e=s("0119"),o=s.n(e);for(var n in e)"default"!==n&&function(t){s.d(a,t,function(){return e[t]})}(n);a["default"]=o.a},dea4:function(t,a,s){"use strict";var e=function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("v-uni-view",[s("QSInput",{attrs:{variableName:"input",required:"",layout:"column",title:"角色类别"},model:{value:t.postdata.name,callback:function(a){t.$set(t.postdata,"name",a)},expression:"postdata.name"}}),s("QSTextarea",{attrs:{variableName:"textarea",textareaWidth:"100",layout:"column",title:"类别简介"},model:{value:t.postdata.intro,callback:function(a){t.$set(t.postdata,"intro",a)},expression:"postdata.intro"}}),s("v-uni-view",{staticClass:"property"},[s("v-uni-view",{staticClass:"title"},[t._v("类别属性")]),s("v-uni-view",{staticClass:"one_property"},[s("v-uni-view",{staticClass:"childrenBOX"},[s("QSInput",{attrs:{variableName:"input",disabled:!0,required:"",layout:"row"},model:{value:t.postdata.npcClassAttrVos[0].name,callback:function(a){t.$set(t.postdata.npcClassAttrVos[0],"name",a)},expression:"postdata.npcClassAttrVos[0].name"}}),s("QSInput",{attrs:{variableName:"input",required:"",placeholder:"属性别名",layout:"row"},model:{value:t.postdata.npcClassAttrVos[0].nickname,callback:function(a){t.$set(t.postdata.npcClassAttrVos[0],"nickname",a)},expression:"postdata.npcClassAttrVos[0].nickname"}})],1),s("QSPickerCustom",{ref:"pickerCustom1",attrs:{title:"选择跟随玩家",pickerTitle:"跟随玩家"},model:{value:t.postdata.npcClassAttrVos[0].value,callback:function(a){t.$set(t.postdata.npcClassAttrVos[0],"value",a)},expression:"postdata.npcClassAttrVos[0].value"}})],1),s("v-uni-view",{staticClass:"one_property"},[s("v-uni-view",{staticClass:"childrenBOX"},[s("QSInput",{attrs:{variableName:"input",disabled:!0,required:"",layout:"row"},model:{value:t.postdata.npcClassAttrVos[1].name,callback:function(a){t.$set(t.postdata.npcClassAttrVos[1],"name",a)},expression:"postdata.npcClassAttrVos[1].name"}}),s("QSInput",{attrs:{variableName:"input",required:"",placeholder:"属性别名",layout:"row"},model:{value:t.postdata.npcClassAttrVos[1].nickname,callback:function(a){t.$set(t.postdata.npcClassAttrVos[1],"nickname",a)},expression:"postdata.npcClassAttrVos[1].nickname"}})],1),s("QSPickerCustom",{ref:"pickerCustom2",attrs:{title:"选择可被询问",pickerTitle:"可被询问"},model:{value:t.postdata.npcClassAttrVos[1].value,callback:function(a){t.$set(t.postdata.npcClassAttrVos[1],"value",a)},expression:"postdata.npcClassAttrVos[1].value"}})],1),t.updateview?s("v-uni-view",{staticClass:"one_property"},[s("v-uni-view",{staticClass:"childrenBOX"},[s("QSInput",{attrs:{variableName:"input",disabled:!0,required:"",layout:"row"},model:{value:t.postdata.npcClassAttrVos[2].name,callback:function(a){t.$set(t.postdata.npcClassAttrVos[2],"name",a)},expression:"postdata.npcClassAttrVos[2].name"}}),s("QSInput",{attrs:{variableName:"input",required:"",placeholder:"属性别名",layout:"row"},model:{value:t.postdata.npcClassAttrVos[2].nickname,callback:function(a){t.$set(t.postdata.npcClassAttrVos[2],"nickname",a)},expression:"postdata.npcClassAttrVos[2].nickname"}})],1),s("QSPickerCustom",{ref:"pickerCustom3",staticClass:"othermm",attrs:{title:"选择所在地点",pickerTitle:"所在地点",placherhold:t.pickerValue2},model:{value:t.postdata.npcClassAttrVos[2].value,callback:function(a){t.$set(t.postdata.npcClassAttrVos[2],"value",a)},expression:"postdata.npcClassAttrVos[2].value"}})],1):t._e(),s("v-uni-view",{staticClass:"one_property"},[s("v-uni-view",{staticClass:"childrenBOX"},[s("QSInput",{attrs:{variableName:"input",disabled:!0,required:"",layout:"row"},model:{value:t.postdata.npcClassAttrVos[3].name,callback:function(a){t.$set(t.postdata.npcClassAttrVos[3],"name",a)},expression:"postdata.npcClassAttrVos[3].name"}}),s("QSInput",{attrs:{variableName:"input",required:"",placeholder:"属性别名",layout:"row"},model:{value:t.postdata.npcClassAttrVos[3].nickname,callback:function(a){t.$set(t.postdata.npcClassAttrVos[3],"nickname",a)},expression:"postdata.npcClassAttrVos[3].nickname"}})],1),s("QSPickerCustom",{ref:"pickerCustom4",attrs:{title:"选择能否说话",pickerTitle:"能否说话"},model:{value:t.postdata.npcClassAttrVos[3].value,callback:function(a){t.$set(t.postdata.npcClassAttrVos[3],"value",a)},expression:"postdata.npcClassAttrVos[3].value"}})],1),s("v-uni-button",{staticClass:"uni-button",attrs:{type:"default"},on:{click:function(a){a=t.$handleEvent(a),t.addotherproperty(a)}}},[t._v("增加其他属性")]),t._l(t.addotherpropertylist,function(a,e){return s("v-uni-view",{staticClass:"one_property2"},[s("QSInput",{staticClass:"other",attrs:{variableName:"input",required:"",placeholder:"属性名称",layout:"row"},model:{value:t.addotherpropertylist[e].name,callback:function(a){t.$set(t.addotherpropertylist[e],"name",a)},expression:"addotherpropertylist[index].name"}}),s("QSInput",{staticClass:"other",attrs:{variableName:"input",required:"",placeholder:"属性别名",layout:"row"},model:{value:t.addotherpropertylist[e].nickname,callback:function(a){t.$set(t.addotherpropertylist[e],"nickname",a)},expression:"addotherpropertylist[index].nickname"}}),s("QSInput",{staticClass:"other",attrs:{variableName:"input",required:"",placeholder:"属性值",layout:"row"},model:{value:t.addotherpropertylist[e].value,callback:function(a){t.$set(t.addotherpropertylist[e],"value",a)},expression:"addotherpropertylist[index].value"}}),"push"===t.operation?s("fa-icon",{staticClass:"icon",attrs:{type:"minus-circle operation_icon",size:"20",color:"#666"},on:{click:function(s){s=t.$handleEvent(s),t.deleteohter(a)}}}):t._e()],1)}),s("v-uni-button",{staticClass:"uni-button2",attrs:{type:"primary",plain:"true"},on:{click:function(a){a=t.$handleEvent(a),t.submitdata(a)}}},[t._v(t._s("push"===t.operation?"确认添加":"确认编辑"))])],2)],1)},o=[];s.d(a,"a",function(){return e}),s.d(a,"b",function(){return o})},f482:function(t,a,s){"use strict";s.r(a);var e=s("dea4"),o=s("9aa9f");for(var n in o)"default"!==n&&function(t){s.d(a,t,function(){return o[t]})}(n);s("2d17");var i=s("2877"),l=Object(i["a"])(o["default"],e["a"],e["b"],!1,null,"2fd516f0",null);a["default"]=l.exports}}]);