(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-workpage-map-editor"],{"0b99":function(e,a,t){"use strict";var o=t("f7b9"),n=t.n(o);n.a},"47cc":function(e,a,t){"use strict";var o=t("288e");Object.defineProperty(a,"__esModule",{value:!0}),a.speCharCheck=i,a.lg_cn_Check=l,a.lg_en_Check=s,a.versionCheck=r,a.onlyCnCheck=c,a.onlywonum=u,a.strFilter=d,a.trimExcel=m;var n=o(t("e814"));function i(e){var a=/[`~!@#$%^&*()_+-<>?:"{},.\/;'[\]]/im,t=/[·！#￥（——）：；“-”‘、，|《。》？、【】[\]]/im;return console.log(a.test(e),t.test(e)),!a.test(e)&&!t.test(e)||(Message({message:"不能存在特殊字符！",type:"warning"}),!1)}function l(e){var a=/^[0-9\u4e00-\u9fa5]+$/;return console.log(a.test(e),"str",a),!!a.test(e)}function s(e){var a=/^[0-9a-z]+$/;return console.log(a.test(e),"str",a),!!a.test(e)}function r(e){var a=/^[0-9.v]+$/;return"v"===e[0]&&!!a.test(e)}function c(e){var a=/^[\u4e00-\u9fa5]+$/;return console.log(a.test(e),"str",a),!!a.test(e)}function u(e){var a=/^-?\d+\.?\d{0,2}$/;return console.log(a.test(e),"str",a),!!a.test(e)}function d(e){return e=e.replace(/，/g,"，"),e=e.replace(/!/g,"！"),e=e.replace(/；/g,";"),e=e.replace(/;/g,""),e}function m(e,a){var t={},o={};for(var i in a?(t={plotNum:"A",question:"B",npc:"C",mood:"D",answer:"E"},o={sheetsName:{A1:{t:"s",v:"剧情编号"},B1:{t:"s",v:"问题"},C1:{t:"s",v:"角色"},D1:{t:"s",v:"语气"},E1:{t:"s",v:"回答"}}}):(t={question:"A",npc:"B",mood:"C",answer:"D"},o={sheetsName:{A1:{t:"s",v:"问题"},B1:{t:"s",v:"角色"},C1:{t:"s",v:"语气"},D1:{t:"s",v:"回答"}}}),console.log(e,"要导出的数据"),e){for(var l in e[i])console.log(l,"键名"),o.sheetsName[t[l]+((0,n.default)(i)+2)]={t:"s",v:e[i][l]},0}return o}t("a481")},"908a":function(e,a,t){"use strict";var o=t("288e");Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var n=o(t("e814")),i=o(t("5d73"));t("28a5"),t("a481");var l=o(t("f499"));t("7f7f");var s=o(t("bd86")),r=t("47cc"),c={data:function(){var e;return{workinfo:{},postdata:(e={name:"",nickname:"",goFlag:"",ableGoName:[],ableGo:[],intro:"",isBase:""},(0,s.default)(e,"isBase",!1),(0,s.default)(e,"projectId",""),e),placeLevel:[{value:1,name:"相邻可达"},{value:2,name:"相通可达"},{value:3,name:"任意可达"},{value:4,name:"不可到达"}],ableGoName:[],buttonname:"增加地点",operation_type:"push"}},methods:{getdatalist:function(){console.log(this.workinfo,"当前作品数据");var e=this;e.$request.get("/place/?projectId="+e.workinfo.id).then(function(a){var t=[];for(var o in a.data){var n={name:a.data[o].name,value:a.data[o].id};t.push(n)}e.ableGoName=t}).catch(function(e){console.error("error:",e)})},senddata:function(){var e=JSON.parse((0,l.default)(this.postdata));if("push"===this.operation_type){if(""===e.name)return void uni.showToast({icon:"none",position:"bottom",title:"请输入地点名"});if(e.nickname){var a=e.nickname.replace(/，/g,","),t=a.split(","),o=!0,n=!1,s=void 0;try{for(var c,u=(0,i.default)(t);!(o=(c=u.next()).done);o=!0){var d=c.value,m=d.replace(/｛/g,"{");m=m.split("{")[0];var f=(0,r.lg_cn_Check)(m);if(!f)return void uni.showToast({icon:"none",position:"bottom",title:"地点别名只能输入中文、数字与逗号"})}}catch(I){n=!0,s=I}finally{try{o||null==u.return||u.return()}finally{if(n)throw s}}e.nickname=a}if(e.projectId=this.workinfo.id,0===e.ableGoName.length&&(e.ableGoName="",e.ableGo=[]),0!==e.ableGoName.length){for(var v in e.ableGoName)for(var p in this.ableGoName)e.ableGoName[v]===this.ableGoName[p].value&&e.ableGo.push(this.ableGoName[p].value);var h=[];for(var b in e.ableGoName)for(var g in this.ableGoName)e.ableGoName[b]===this.ableGoName[p].value&&h.push(this.ableGoName[g].name);e.ableGoName=h,e.ableGoName=e.ableGoName.join(",")}console.log(e,"提交的数据"),uni.showLoading({title:"添加地点中"});var N=this;this.$request.post("/place/",e).then(function(e){uni.hideLoading(),1===e.code?uni.showModal({title:"提示",content:"添加地点成功",cancelText:"继续添加",confirmText:"返回列表",success:function(e){e.confirm?(console.log("点击确定"),N.is_typeshow=!1,N.getdatalist(),uni.navigateBack({delta:1})):e.cancel&&N.getdatalist()}}):uni.showModal({title:"提示",content:e.msg,cancelText:"继续添加",confirmText:"返回列表",success:function(e){e.confirm?(N.is_typeshow=!1,N.getdatalist(),uni.navigateBack({delta:1})):e.cancel&&N.getdatalist()}}),console.log(e)}).catch(function(e){console.log(e)})}else if("change"===this.operation_type){if(console.log(e,"提交的数据1"),""===e.name)return void uni.showToast({icon:"none",position:"bottom",title:"请输入地点名"});if(e.nickname){var G=e.nickname.replace(/，/g,","),w=G.split(","),k=!0,y=!1,_=void 0;try{for(var x,C=(0,i.default)(w);!(k=(x=C.next()).done);k=!0){var $=x.value,T=$.replace(/｛/g,"{");T=T.split("{")[0];var B=(0,r.lg_cn_Check)(T);if(!B)return void uni.showToast({icon:"none",position:"bottom",title:"地点别名只能输入中文、数字与逗号"})}}catch(I){y=!0,_=I}finally{try{k||null==C.return||C.return()}finally{if(y)throw _}}e.nickname=G}if(e.projectId=this.workinfo.id,0===e.ableGoName.length&&(e.ableGoName="",e.ableGo=[]),0!==e.ableGoName.length){var j=[];for(var v in e.ableGoName)for(var p in this.ableGoName)e.ableGoName[v]==this.ableGoName[p].value&&j.push(this.ableGoName[p].value);e.ableGo=j;var S=[];for(var b in e.ableGoName)for(var g in this.ableGoName)e.ableGoName[b]==this.ableGoName[g].value&&S.push(this.ableGoName[g].name);e.ableGoName=S,e.ableGoName=e.ableGoName.join(",")}console.log(e,"提交的数据"),uni.showLoading({title:"添加地点中"});var M=this;this.$request.put("/place/"+e.id+"/",e).then(function(e){uni.hideLoading(),1===e.code?uni.showModal({title:"提示",content:"修改地点成功",cancelText:"继续修改",confirmText:"返回列表",success:function(e){e.confirm?(console.log("点击确定"),M.is_typeshow=!1,M.getdatalist(),uni.navigateBack({delta:1})):e.cancel&&M.getdatalist()}}):uni.showModal({title:"提示",content:e.msg,cancelText:"继续修改",confirmText:"返回列表",success:function(e){e.confirm?(M.is_typeshow=!1,M.getdatalist(),uni.navigateBack({delta:1})):e.cancel&&M.getdatalist()}}),console.log(e)}).catch(function(e){console.log(e)})}}},onShow:function(){},onLoad:function(e){var a=uni.getStorageSync("workinfo");if(this.workinfo=a,e.mapinfo){this.buttonname="修改地点",this.getdatalist(),this.operation_type="change";var t=JSON.parse(e.mapinfo);console.log(t,"接受的数据");var o=[];for(var i in this.ableGoName)if(t.name!==this.ableGoName[i].name){var l={name:this.ableGoName[i].name,value:this.ableGoName[i].name};o.push(l)}this.ableGoName=o,this.postdata=t;var s=t.ableGo.map(function(e){return(0,n.default)(e)});this.postdata.ableGoName=s,console.log(this.postdata.ableGoName,"转换类型后的数据")}else this.getdatalist(),this.operation_type="push",this.buttonname="增加地点",this.postdata={name:"",nickname:"",goFlag:"",ableGoName:[],ableGo:[],intro:"",isBase:!1,projectId:""}},mounted:function(){}};a.default=c},"9c9b":function(e,a,t){"use strict";t.r(a);var o=t("908a"),n=t.n(o);for(var i in o)"default"!==i&&function(e){t.d(a,e,function(){return o[e]})}(i);a["default"]=n.a},b581:function(e,a,t){"use strict";t.r(a);var o=t("b710"),n=t("9c9b");for(var i in n)"default"!==i&&function(e){t.d(a,e,function(){return n[e]})}(i);t("0b99");var l=t("2877"),s=Object(l["a"])(n["default"],o["a"],o["b"],!1,null,"b882e194",null);a["default"]=s.exports},b710:function(e,a,t){"use strict";var o=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("v-uni-view",[t("QSInput",{attrs:{variableName:"input",required:"",layout:"column",title:"地点名称"},model:{value:e.postdata.name,callback:function(a){e.$set(e.postdata,"name",a)},expression:"postdata.name"}}),t("QSInput",{attrs:{variableName:"input",layout:"column",title:"地点别名",placeholder:"用逗号分隔"},model:{value:e.postdata.nickname,callback:function(a){e.$set(e.postdata,"nickname",a)},expression:"postdata.nickname"}}),t("QSRadio",{staticClass:"addboder",attrs:{variableName:"radio",layout:"row",title:"到达条件",itemArray:e.placeLevel},model:{value:e.postdata.goFlag,callback:function(a){e.$set(e.postdata,"goFlag",a)},expression:"postdata.goFlag"}}),t("QSCheckbox",{staticClass:"addboder",attrs:{variableName:"checkbox",value:"ableGoName.name",layout:"column",title:"可去地点",itemArray:e.ableGoName},on:{chane:function(a){a=e.$handleEvent(a),e.demo(a)}},model:{value:e.postdata.ableGoName,callback:function(a){e.$set(e.postdata,"ableGoName",a)},expression:"postdata.ableGoName"}}),t("QSTextarea",{attrs:{variableName:"textarea",textareaWidth:"100",layout:"column",title:"地点简介"},model:{value:e.postdata.intro,callback:function(a){e.$set(e.postdata,"intro",a)},expression:"postdata.intro"}}),t("v-uni-button",{staticClass:"margin-top buttonwidth ",attrs:{type:"primary",plain:"true"},on:{click:function(a){a=e.$handleEvent(a),e.senddata(a)}}},[e._v(e._s(e.buttonname))])],1)},n=[];t.d(a,"a",function(){return o}),t.d(a,"b",function(){return n})},f7b9:function(e,a,t){var o=t("f8e6");"string"===typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);var n=t("4f06").default;n("53f9a184",o,!0,{sourceMap:!1,shadowMode:!1})},f8e6:function(e,a,t){a=e.exports=t("2350")(!1),a.push([e.i,".margin-top[data-v-b882e194]{margin-top:%?20?%}.addboder[data-v-b882e194]{border-bottom:1px solid #f2f2f2}.buttonwidth[data-v-b882e194]{width:90%}",""])}}]);