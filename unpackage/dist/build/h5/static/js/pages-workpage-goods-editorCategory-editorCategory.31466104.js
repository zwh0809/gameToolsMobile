(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-workpage-goods-editorCategory-editorCategory"],{1775:function(t,a,o){"use strict";var s=o("288e");Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var e=s(o("e814"));o("7f7f");var i=s(o("f499")),l=s(o("a745")),r={data:function(){return{postdata:{goodsClassAttrVos:[{name:"可被询问",value:"",nickname:"",isBase:!0},{name:"所属角色",value:"",nickname:"",isBase:!0},{name:"所在地点",value:"",nickname:"",isBase:!0}],id:"",name:"",intro:"",projectId:""},NPClist:[],Maplist:[],allNPClist:[],allMaplist:[],steps1:{step_1_value:"name"},inquire:[["是","否"]],addotherpropertylist:[],workinfo:{},operation:"push",pickerValue1:"",pickerValue2:"",updateview:!0}},methods:{deepCopy:function(t){var a=(0,l.default)(t)?[]:{};for(var o in t)t.hasOwnProperty(o)&&("object"===typeof t[o]&&null!==t[o]?a[o]=this.deepCopy(t[o]):a[o]=t[o]);return a},demo:function(t){},submitdata:function(){var t=JSON.parse((0,i.default)(this.postdata));if(console.log(this.operation,"状态"),"push"===this.operation){for(var a in t.goodsClassAttrVos)""===t.goodsClassAttrVos[a].nickname&&(t.goodsClassAttrVos[a].nickname=null);if(t.goodsClassAttrVos=t.goodsClassAttrVos.concat(this.addotherpropertylist),""!==t.goodsClassAttrVos[0].value){console.log("发生了");var o=t.goodsClassAttrVos[0].value.data[0];"否"===o?t.goodsClassAttrVos[0].value="否":"是"===o&&(t.goodsClassAttrVos[0].value="是")}if(""!==t.goodsClassAttrVos[1].value){var s=t.goodsClassAttrVos[1].value.data[0];for(var a in this.allNPClist)this.allNPClist[a].name===s&&(t.goodsClassAttrVos[1].value=this.allNPClist[a].id)}if(""!==t.goodsClassAttrVos[2].value){var e=t.goodsClassAttrVos[2].value.data[0];for(var a in this.allMaplist)this.allMaplist[a].name===e&&(t.goodsClassAttrVos[2].value=this.allMaplist[a].id)}if(!t.name)return void uni.showToast({icon:"none",title:"分类名称不能为空"});t.projectId=this.workinfo.id,console.log(t,"提交的数据");var l=this;l.$request.post("/goods/class/",t).then(function(t){console.log(t),1===t.code?uni.showModal({title:"提示",content:"添加类别成功",cancelText:"继续添加",confirmText:"返回列表",success:function(t){t.confirm?(console.log("点击确定"),uni.navigateBack({delta:1})):t.cancel}}):uni.showModal({title:"提示",content:t.msg,cancelText:"继续添加",confirmText:"返回列表",success:function(t){t.confirm?(console.log("点击确定"),uni.navigateBack({delta:1})):t.cancel}})}).catch(function(t){console.log(t)})}else if("change"===this.operation){for(var a in console.log(t,"编辑提交的数据"),t.goodsClassAttrVos)""===t.goodsClassAttrVos[a].nickname&&(t.goodsClassAttrVos[a].nickname=null);if(t.goodsClassAttrVos=t.goodsClassAttrVos.concat(this.addotherpropertylist),""!==t.goodsClassAttrVos[0].value){var r=t.goodsClassAttrVos[0].value.value[0];1===r?t.goodsClassAttrVos[0].value="否":0===r&&(t.goodsClassAttrVos[0].value="是")}if(""!==t.goodsClassAttrVos[1].value){var n=t.goodsClassAttrVos[1].value.data[0];for(var a in this.allNPClist)this.allNPClist[a].name===n&&(t.goodsClassAttrVos[1].value=this.allNPClist[a].id)}if(""!==t.goodsClassAttrVos[2].value){var d=t.goodsClassAttrVos[2].value.data[0];for(var a in this.allMaplist)this.allMaplist[a].name===d&&(t.goodsClassAttrVos[2].value=this.allMaplist[a].id)}if(!t.name)return void uni.showToast({icon:"none",title:"分类名称不能为空"});t.projectId=this.workinfo.id;var c=this;c.$request.put("/goods/class//"+t.id+"/",t).then(function(t){console.log(t),1===t.code?uni.showModal({title:"提示",content:"编辑类别成功",cancelText:"继续编辑",confirmText:"返回列表",success:function(t){t.confirm?(console.log("点击确定"),uni.navigateBack({delta:1})):t.cancel}}):uni.showModal({title:"提示",content:t.msg,cancelText:"继续编辑",confirmText:"返回列表",success:function(t){t.confirm?(console.log("点击确定"),uni.navigateBack({delta:1})):t.cancel}})}).catch(function(t){console.log(t)})}},deleteohter:function(t){var a=this.addotherpropertylist.indexOf(t);-1!==a&&this.addotherpropertylist.splice(a,1)},addotherproperty:function(){var t={name:"",value:"",nickname:"",isBase:!0};this.addotherpropertylist.push(t)},getmaplist:function(){var t=this;t.$request.get("/place/?projectId="+t.workinfo.id).then(function(a){var o=[[]];for(var s in a.data)o[0].push(a.data[s].name);t.allMaplist=a.data,t.Maplist=o,t.setPickerDatac()}).catch(function(t){console.error("error:",t)})},getNPClist:function(){var t=this;t.$request.get("/npc/instance_by_project_id/"+t.workinfo.id+"/").then(function(a){var o=[[]];for(var s in a.data)o[0].push(a.data[s].name);t.allNPClist=a.data,t.NPClist=o,t.setPickerDatac()}).catch(function(t){console.error("error:",t)})},initialize1:function(){var t=this;t.$request.get("/npc/instance_by_project_id/"+t.workinfo.id+"/").then(function(a){var o=[[]];for(var s in a.data)o[0].push(a.data[s].name);if(t.allNPClist=a.data,t.NPClist=o,""!==t.postdata.goodsClassAttrVos[1].value){var i=t.postdata.goodsClassAttrVos[1].value;for(var s in t.allNPClist)t.allNPClist[s].id===(0,e.default)(i)&&(t.postdata.goodsClassAttrVos[1].value={data:[t.allNPClist[s].name],value:[(0,e.default)(s)]},t.$set(t.postdata.goodsClassAttrVos,1,t.postdata.goodsClassAttrVos[1]))}t.initialize2()}).catch(function(t){console.error("error:",t)})},initialize2:function(){var t=this;t.$request.get("/place/?projectId="+t.workinfo.id).then(function(a){var o=[[]];for(var s in a.data)o[0].push(a.data[s].name);if(t.allMaplist=a.data,t.Maplist=o,""!==t.postdata.goodsClassAttrVos[2].value){var i=t.postdata.goodsClassAttrVos[2].value;for(var s in t.allMaplist)t.allMaplist[s].id===(0,e.default)(i)&&(t.postdata.goodsClassAttrVos[2].value={data:[t.allMaplist[s].name],value:[(0,e.default)(s)]},t.$set(t.postdata.goodsClassAttrVos,2,t.postdata.goodsClassAttrVos[2]))}t.updateview=!0,console.log(t.updateview,"此时的updateview"),t.$nextTick(function(){t.setPickerDatac2()})}).catch(function(t){console.error("error:",t)})},setPickerDatac:function(){this.$refs.pickerCustom1.setData(this.inquire),this.$refs.pickerCustom2.setData(this.NPClist),this.$refs.pickerCustom3.setData(this.Maplist)},setPickerDatac2:function(){!0===this.updateview&&(this.$refs.pickerCustom1.setData(this.inquire),this.$refs.pickerCustom2.setData(this.NPClist),this.$refs.pickerCustom3.setData(this.Maplist))}},mounted:function(){},onShow:function(){},onLoad:function(t){var a=uni.getStorageSync("workinfo");if(this.workinfo=a,t.categoryinfo){this.updateview=!1,console.log(this.updateview,"状态1");var o=JSON.parse(t.categoryinfo);console.log(o,"接收的数据");var s=[];for(var e in o.goodsClassAttrVos)null===o.goodsClassAttrVos[e].nickname&&(o.goodsClassAttrVos[e].nickname=""),e>2&&s.push(o.goodsClassAttrVos[e]);if(this.addotherpropertylist=s,this.postdata=o,this.initialize1(),""!==this.postdata.goodsClassAttrVos[0].value){var i=this.postdata.goodsClassAttrVos[0].value;"是"===i?this.postdata.goodsClassAttrVos[0].value={data:["是"],value:[0]}:"否"===i&&(this.postdata.goodsClassAttrVos[0].value={data:["否"],value:[1]})}this.operation="change"}else this.pickerValue1="请选择",this.pickerValue2="请选择",this.getmaplist(),this.getNPClist()}};a.default=r},3842:function(t,a,o){"use strict";o.r(a);var s=o("6bca"),e=o("ad00");for(var i in e)"default"!==i&&function(t){o.d(a,t,function(){return e[t]})}(i);o("788c");var l=o("2877"),r=Object(l["a"])(e["default"],s["a"],s["b"],!1,null,"206fb603",null);a["default"]=r.exports},"6bca":function(t,a,o){"use strict";var s=function(){var t=this,a=t.$createElement,o=t._self._c||a;return o("v-uni-view",[o("QSInput",{attrs:{variableName:"input",required:"",layout:"column",title:"物品类别"},model:{value:t.postdata.name,callback:function(a){t.$set(t.postdata,"name",a)},expression:"postdata.name"}}),o("QSTextarea",{attrs:{variableName:"textarea",textareaWidth:"100",layout:"column",title:"物品简介"},model:{value:t.postdata.intro,callback:function(a){t.$set(t.postdata,"intro",a)},expression:"postdata.intro"}}),o("v-uni-view",{staticClass:"property"},[o("v-uni-view",{staticClass:"title"},[t._v("类别属性")]),o("v-uni-view",{staticClass:"one_property"},[o("v-uni-view",{staticClass:"childrenBOX"},[o("QSInput",{attrs:{variableName:"input",disabled:!0,required:"",layout:"row"},model:{value:t.postdata.goodsClassAttrVos[0].name,callback:function(a){t.$set(t.postdata.goodsClassAttrVos[0],"name",a)},expression:"postdata.goodsClassAttrVos[0].name"}}),o("QSInput",{attrs:{variableName:"input",required:"",placeholder:"属性别名",layout:"row"},model:{value:t.postdata.goodsClassAttrVos[0].nickname,callback:function(a){t.$set(t.postdata.goodsClassAttrVos[0],"nickname",a)},expression:"postdata.goodsClassAttrVos[0].nickname"}})],1),o("QSPickerCustom",{ref:"pickerCustom1",attrs:{title:"选择是否可被询问",pickerTitle:"可被询问"},model:{value:t.postdata.goodsClassAttrVos[0].value,callback:function(a){t.$set(t.postdata.goodsClassAttrVos[0],"value",a)},expression:"postdata.goodsClassAttrVos[0].value"}})],1),t.updateview?o("v-uni-view",{staticClass:"one_property "},[o("v-uni-view",{staticClass:"childrenBOX"},[o("QSInput",{attrs:{variableName:"input",disabled:!0,required:"",layout:"row"},model:{value:t.postdata.goodsClassAttrVos[1].name,callback:function(a){t.$set(t.postdata.goodsClassAttrVos[1],"name",a)},expression:"postdata.goodsClassAttrVos[1].name"}}),o("QSInput",{attrs:{variableName:"input",required:"",placeholder:"属性别名",layout:"row"},model:{value:t.postdata.goodsClassAttrVos[1].nickname,callback:function(a){t.$set(t.postdata.goodsClassAttrVos[1],"nickname",a)},expression:"postdata.goodsClassAttrVos[1].nickname"}})],1),o("QSPickerCustom",{ref:"pickerCustom2",staticClass:"othermm",attrs:{title:"选择所属角色",value:1,placherhold:t.pickerValue1,pickerTitle:"所属角色"},on:{change:function(a){a=t.$handleEvent(a),t.demo(a)}},model:{value:t.postdata.goodsClassAttrVos[1].value,callback:function(a){t.$set(t.postdata.goodsClassAttrVos[1],"value",a)},expression:"postdata.goodsClassAttrVos[1].value"}})],1):t._e(),t.updateview?o("v-uni-view",{staticClass:"one_property"},[o("v-uni-view",{staticClass:"childrenBOX"},[o("QSInput",{attrs:{variableName:"input",disabled:!0,required:"",layout:"row"},model:{value:t.postdata.goodsClassAttrVos[2].name,callback:function(a){t.$set(t.postdata.goodsClassAttrVos[2],"name",a)},expression:"postdata.goodsClassAttrVos[2].name"}}),o("QSInput",{attrs:{variableName:"input",required:"",placeholder:"属性别名",layout:"row"},model:{value:t.postdata.goodsClassAttrVos[2].nickname,callback:function(a){t.$set(t.postdata.goodsClassAttrVos[2],"nickname",a)},expression:"postdata.goodsClassAttrVos[2].nickname"}})],1),o("QSPickerCustom",{ref:"pickerCustom3",staticClass:"othermm",attrs:{title:"选择所在地点",pickerTitle:"所在地点",placherhold:t.pickerValue2},model:{value:t.postdata.goodsClassAttrVos[2].value,callback:function(a){t.$set(t.postdata.goodsClassAttrVos[2],"value",a)},expression:"postdata.goodsClassAttrVos[2].value"}})],1):t._e(),o("v-uni-button",{staticClass:"uni-button",attrs:{type:"default"},on:{click:function(a){a=t.$handleEvent(a),t.addotherproperty(a)}}},[t._v("增加其他属性")]),t._l(t.addotherpropertylist,function(a,s){return o("v-uni-view",{staticClass:"one_property2"},[o("QSInput",{staticClass:"other",attrs:{variableName:"input",required:"",placeholder:"属性名称",layout:"row"},model:{value:t.addotherpropertylist[s].name,callback:function(a){t.$set(t.addotherpropertylist[s],"name",a)},expression:"addotherpropertylist[index].name"}}),o("QSInput",{staticClass:"other",attrs:{variableName:"input",required:"",placeholder:"属性别名",layout:"row"},model:{value:t.addotherpropertylist[s].nickname,callback:function(a){t.$set(t.addotherpropertylist[s],"nickname",a)},expression:"addotherpropertylist[index].nickname"}}),o("QSInput",{staticClass:"other",attrs:{variableName:"input",required:"",placeholder:"属性值",layout:"row"},model:{value:t.addotherpropertylist[s].value,callback:function(a){t.$set(t.addotherpropertylist[s],"value",a)},expression:"addotherpropertylist[index].value"}}),"push"===t.operation?o("fa-icon",{staticClass:"icon",attrs:{type:"minus-circle operation_icon",size:"20",color:"#666"},on:{click:function(o){o=t.$handleEvent(o),t.deleteohter(a)}}}):t._e()],1)}),o("v-uni-button",{staticClass:"uni-button2",attrs:{type:"primary",plain:"true"},on:{click:function(a){a=t.$handleEvent(a),t.submitdata(a)}}},[t._v(t._s("push"===t.operation?"确认添加":"确认编辑"))])],2)],1)},e=[];o.d(a,"a",function(){return s}),o.d(a,"b",function(){return e})},"788c":function(t,a,o){"use strict";var s=o("bb61"),e=o.n(s);e.a},ad00:function(t,a,o){"use strict";o.r(a);var s=o("1775"),e=o.n(s);for(var i in s)"default"!==i&&function(t){o.d(a,t,function(){return s[t]})}(i);a["default"]=e.a},b9a5:function(t,a,o){a=t.exports=o("2350")(!1),a.push([t.i,".property[data-v-206fb603]{font-size:%?32?%;color:#666;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column}.one_property[data-v-206fb603]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;border:1px solid #f8f8f8;margin-top:%?20?%}.one_property2[data-v-206fb603]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row}.title[data-v-206fb603]{margin-left:%?20?%}.uni-button[data-v-206fb603]{text-align:center;font-size:%?32?%;color:#666;height:%?60?%;line-height:%?60?%;border-radius:%?10?%;margin-top:%?20?%;margin-left:0}.other[data-v-206fb603]{padding:10px;width:30%!important}.icon[data-v-206fb603]{margin-top:%?40?%}.uni-button2[data-v-206fb603]{width:100%;margin-top:%?20?%}.childrenBOX[data-v-206fb603]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row}",""])},bb61:function(t,a,o){var s=o("b9a5");"string"===typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);var e=o("4f06").default;e("7dc90f98",s,!0,{sourceMap:!1,shadowMode:!1})}}]);